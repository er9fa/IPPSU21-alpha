<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<select class="js-example-basic-single" style="width: 16rem;">
</select>
<script>
    $(document).ready(() => {
        $('.js-example-basic-single').select2({
            placeholder: 'Select an option'
        })
    })

    // Fixes a bug where the dropdown search bar isn't automatically focused
    $(document).on('select2:open', () => {
        document.querySelector('.select2-search__field').focus();
    })

    // TODO: Maybe place this function in a helper file
    async function convertPopularCoinsToDropdownOptions() {
        // Bind popular coins to the drop down menu
        const popularCoinsFormatted = await getPopularCoins().then(coins => {
            const formattedCoins = []
            // Convert the retrieved coins into the format the dropdown menu library requires to display them (see Select2 library for more details)
            coins.forEach((coin, index) => {
                coinFormatted = {
                    id: index,
                    text: coin.tickerSymbol + " " + coin.name
                }
                formattedCoins.push(coinFormatted)
            })
            return formattedCoins
        })
        return popularCoinsFormatted
    }

    // Binds an array of options to the dropdown menu
    // To bind a list of popular coins to the dropdown, call convertPopularCoins to obtain a list of coins in the proper format, and then call this function
    function bindOptionsToDropdown(arrayOfOptions) {
        $(".js-example-basic-single").select2({
            data: arrayOfOptions
        })
    }

    // Sets a listener for whenever the user selects an option from the dropdown
    // Passes through the selected option's text as a parameter
    function setOnChangeListenerForDropdown(listener) {
        // Bind an event
        $('.js-example-basic-single').on('change', () => {
            value = $('.js-example-basic-single').select2('data')[0].text // Retrieves the text of the selected option
            listener(value) // Executes the listener and passes through the selected option as a parameter
        });
    }

</script>